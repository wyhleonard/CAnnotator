import { useEffect, useRef, useState } from "react";
import "../../sharedCss.css";
import "./SpacePlot.css";
import * as d3 from "d3";

const demoScaterPlotData = [
    [
        {
            "position": [
                49.08524639094453,
                59.02295871010538,
                37.92517467775321
            ],
            "color": "#d53c38",
            "type": "space"
        },
        {
            "position": [
                40.399154365442655,
                49.91874109323613,
                30.722687755079814
            ],
            "color": "#ae3230",
            "type": "space"
        },
        {
            "position": [
                42.573865605254646,
                50.520764872540425,
                34.757952292232176
            ],
            "color": "#b6372e",
            "type": "space"
        },
        {
            "position": [
                48.317496702280096,
                55.18463508939947,
                38.3990166273951
            ],
            "color": "#ce4035",
            "type": "space"
        },
        {
            "position": [
                51.88652505478602,
                53.74162109597963,
                41.72053156213828
            ],
            "color": "#d84c37",
            "type": "space"
        },
        {
            "position": [
                47.67133853862916,
                54.72600548548545,
                35.83380532002448
            ],
            "color": "#cb3f38",
            "type": "space"
        },
        {
            "position": [
                32.80410005965097,
                12.855553408317121,
                16.356877654730717
            ],
            "color": "#684534",
            "type": "space"
        },
        {
            "position": [
                32.54486787313601,
                14.106150647699017,
                8.37055970218945
            ],
            "color": "#664440",
            "type": "space"
        },
        {
            "position": [
                27.107604015103625,
                6.462484308613487,
                -4.5000289827394235
            ],
            "color": "#473d47",
            "type": "space"
        },
        {
            "position": [
                25.717079107490292,
                5.32648966387958,
                3.3776000135630424
            ],
            "color": "#473a38",
            "type": "space"
        },
        {
            "position": [
                19.569756268905934,
                0.9176631587155537,
                -1.1204828162508451
            ],
            "color": "#302f31",
            "type": "space"
        },
        {
            "position": [
                25.354159372601522,
                3.784118176891699,
                3.4764888569869257
            ],
            "color": "#443a37",
            "type": "space"
        },
        {
            "position": [
                55.695224142058265,
                49.117057028837394,
                27.286194143077815
            ],
            "color": "#db5d59",
            "type": "space"
        }
    ],
    [
        {
            "position": [
                43.258264859357894,
                48.5738980865486,
                30.260955510265376
            ],
            "color": "#b53c37",
            "type": "space"
        },
        {
            "position": [
                38.858277427739026,
                44.49225357656941,
                25.33273830520696
            ],
            "color": "#a23635",
            "type": "space"
        },
        {
            "position": [
                39.73837732055654,
                44.72300166613186,
                25.928253424227965
            ],
            "color": "#a53836",
            "type": "space"
        },
        {
            "position": [
                45.26814198621389,
                43.202589877754164,
                32.635580696912925
            ],
            "color": "#b54837",
            "type": "space"
        },
        {
            "position": [
                47.862721292072635,
                42.81831872294095,
                35.978441966647964
            ],
            "color": "#bd4f37",
            "type": "space"
        },
        {
            "position": [
                41.331279770432154,
                46.34062926827126,
                27.558885992204807
            ],
            "color": "#ac3a37",
            "type": "space"
        },
        {
            "position": [
                29.771632199713615,
                7.010394004516918,
                7.389033736673378
            ],
            "color": "#55423b",
            "type": "space"
        },
        {
            "position": [
                27.802676768422586,
                12.19550018944643,
                -1.3448839273965452
            ],
            "color": "#533b44",
            "type": "space"
        },
        {
            "position": [
                27.68761860599014,
                13.235721902679437,
                -30.92053911256891
            ],
            "color": "#373d71",
            "type": "space"
        },
        {
            "position": [
                24.44006583903188,
                0.6074063032535937,
                -3.9949197412699644
            ],
            "color": "#383a40",
            "type": "space"
        },
        {
            "position": [
                17.463076174643994,
                0.244902193377472,
                -4.329317238296682
            ],
            "color": "#282b31",
            "type": "space"
        },
        {
            "position": [
                22.615238145286455,
                0.0025726629153122182,
                0.0011768576609894055
            ],
            "color": "#363636",
            "type": "space"
        },
        {
            "position": [
                53.279180566477066,
                41.91247903123774,
                -4.935646040090136
            ],
            "color": "#be6189",
            "type": "space"
        }
    ],
    [
        {
            "position": [
                42.077794458947025,
                49.11337678311234,
                29.908985925046196
            ],
            "color": "#b23835",
            "type": "space"
        },
        {
            "position": [
                39.978904592914915,
                47.31497786979208,
                26.994983519757156
            ],
            "color": "#a93535",
            "type": "space"
        },
        {
            "position": [
                40.55686053763273,
                44.7245609929843,
                28.849685322936036
            ],
            "color": "#a83a33",
            "type": "space"
        },
        {
            "position": [
                50.51490416940247,
                39.60474589692953,
                41.30228264426097
            ],
            "color": "#c25933",
            "type": "space"
        },
        {
            "position": [
                52.79230341034594,
                35.062778353952105,
                46.28575619489583
            ],
            "color": "#c4632e",
            "type": "space"
        },
        {
            "position": [
                43.86265333793465,
                42.67776519422023,
                31.926644616457377
            ],
            "color": "#b04535",
            "type": "space"
        },
        {
            "position": [
                38.89492919395082,
                4.380815907870373,
                24.91073304579934
            ],
            "color": "#6f5833",
            "type": "space"
        },
        {
            "position": [
                30.562089072740463,
                4.81383234581223,
                7.836682753705859
            ],
            "color": "#54453c",
            "type": "space"
        },
        {
            "position": [
                27.443656001506348,
                3.0789512865374293,
                -10.642487479568674
            ],
            "color": "#3d4051",
            "type": "space"
        },
        {
            "position": [
                26.81734488635592,
                -1.7261486652613012,
                3.527278924282007
            ],
            "color": "#3f403a",
            "type": "space"
        },
        {
            "position": [
                17.712695589029927,
                1.2455582928594944,
                -3.228073546426402
            ],
            "color": "#2b2b30",
            "type": "space"
        },
        {
            "position": [
                23.101856841607223,
                -0.011266990597974536,
                1.4064368899737056
            ],
            "color": "#383735",
            "type": "space"
        },
        {
            "position": [
                56.41127212404035,
                31.437134698255377,
                32.11748940398959
            ],
            "color": "#c77051",
            "type": "space"
        }
    ],
    [
        {
            "position": [
                50.16487964373658,
                50.26568514520302,
                39.88725970805158
            ],
            "color": "#ce4c36",
            "type": "space"
        },
        {
            "position": [
                45.53418942284646,
                42.16615687559527,
                30.02479856626026
            ],
            "color": "#b44a3c",
            "type": "space"
        },
        {
            "position": [
                55.45087645804192,
                26.496353487729387,
                47.44196405800088
            ],
            "color": "#c17131",
            "type": "space"
        },
        {
            "position": [
                91.26012733840099,
                -11.884425605145632,
                87.23095561755862
            ],
            "color": "#fce91c",
            "type": "space"
        },
        {
            "position": [
                78.53082476648407,
                15.164904187142225,
                81.2952947381955
            ],
            "color": "#feb500",
            "type": "space"
        },
        {
            "position": [
                71.39688156709596,
                13.824244145059339,
                70.9342992353021
            ],
            "color": "#e4a31b",
            "type": "space"
        },
        {
            "position": [
                54.082223913936204,
                -21.83883823353633,
                43.106425464127184
            ],
            "color": "#738a32",
            "type": "space"
        },
        {
            "position": [
                46.29228739043488,
                -42.51775447078132,
                24.768496857790268
            ],
            "color": "#167e42",
            "type": "space"
        },
        {
            "position": [
                30.638858494614112,
                -15.392336044326937,
                -4.061761462891333
            ],
            "color": "#234f4e",
            "type": "space"
        },
        {
            "position": [
                31.756429135117003,
                -17.409141258517668,
                3.350118913256106
            ],
            "color": "#2b5245",
            "type": "space"
        },
        {
            "position": [
                18.736174180977535,
                -5.019103125431245,
                -4.567340937765718
            ],
            "color": "#213034",
            "type": "space"
        },
        {
            "position": [
                22.376197040352665,
                -5.740168632584474,
                0.22121665444455596
            ],
            "color": "#2c3835",
            "type": "space"
        },
        {
            "position": [
                87.07509427096804,
                -10.918902935693808,
                72.01912523693433
            ],
            "color": "#eddd46",
            "type": "space"
        }
    ],
    [
        {
            "position": [
                51.81006774843247,
                55.76860674794254,
                40.10384659339877
            ],
            "color": "#da493a",
            "type": "space"
        },
        {
            "position": [
                47.80284956505853,
                40.93775155573825,
                33.54303039981188
            ],
            "color": "#ba513b",
            "type": "space"
        },
        {
            "position": [
                51.76670636674342,
                34.41268546809889,
                46.01484008169666
            ],
            "color": "#c0612c",
            "type": "space"
        },
        {
            "position": [
                79.82836082858125,
                12.98545979966631,
                82.22449223690738
            ],
            "color": "#ffba00",
            "type": "space"
        },
        {
            "position": [
                76.59033768302068,
                20.606258603936944,
                75.8237894812702
            ],
            "color": "#ffac1d",
            "type": "space"
        },
        {
            "position": [
                70.18091287275031,
                17.841893099430127,
                70.54749329969046
            ],
            "color": "#e69d19",
            "type": "space"
        },
        {
            "position": [
                49.91865958082832,
                -10.152050178799554,
                43.813433187623616
            ],
            "color": "#7c7a27",
            "type": "space"
        },
        {
            "position": [
                42.12153000813732,
                -21.678537156514686,
                26.00586295905538
            ],
            "color": "#4d6c37",
            "type": "space"
        },
        {
            "position": [
                31.24774176591528,
                -10.759281932863656,
                7.204659343063058
            ],
            "color": "#3c4e3e",
            "type": "space"
        },
        {
            "position": [
                32.39244959363474,
                -14.284467289990305,
                10.039495191633318
            ],
            "color": "#3a523c",
            "type": "space"
        },
        {
            "position": [
                22.081480446404868,
                -2.1900291355097523,
                -2.884122442831738
            ],
            "color": "#2f3639",
            "type": "space"
        },
        {
            "position": [
                26.385446914387636,
                -6.435180330869233,
                6.1003207718840935
            ],
            "color": "#384135",
            "type": "space"
        },
        {
            "position": [
                79.6673983273434,
                12.473932874808524,
                77.88430018199516
            ],
            "color": "#fdba1e",
            "type": "space"
        }
    ],
    [
        {
            "position": [
                47.598482304853924,
                55.905143648190325,
                34.65144050203054
            ],
            "color": "#cc3d3a",
            "type": "space"
        },
        {
            "position": [
                43.27666633301306,
                40.64171578075049,
                28.105930162288228
            ],
            "color": "#ab463a",
            "type": "space"
        },
        {
            "position": [
                44.03205496906962,
                43.04393637175919,
                32.16757043659495
            ],
            "color": "#b14535",
            "type": "space"
        },
        {
            "position": [
                74.80706471639414,
                10.84393031348413,
                75.9139313446696
            ],
            "color": "#ebae10",
            "type": "space"
        },
        {
            "position": [
                71.31300490147102,
                19.120558405315123,
                74.63445124000722
            ],
            "color": "#ec9f07",
            "type": "space"
        },
        {
            "position": [
                65.7824188877595,
                17.391363767770894,
                60.06499649246587
            ],
            "color": "#d6922d",
            "type": "space"
        },
        {
            "position": [
                53.40747036054735,
                -16.93905837554577,
                46.50380733636593
            ],
            "color": "#7b8629",
            "type": "space"
        },
        {
            "position": [
                37.24450020400884,
                -20.509251682247292,
                12.413892080123201
            ],
            "color": "#3a6043",
            "type": "space"
        },
        {
            "position": [
                28.779215544380413,
                -4.97229695694995,
                -12.602575470116218
            ],
            "color": "#2d4757",
            "type": "space"
        },
        {
            "position": [
                28.888630158097534,
                -9.153047752150728,
                3.8055394094021366
            ],
            "color": "#37483e",
            "type": "space"
        },
        {
            "position": [
                18.77490933093287,
                -0.17602603768629432,
                -4.433779198899435
            ],
            "color": "#2a2e34",
            "type": "space"
        },
        {
            "position": [
                22.662567216577017,
                -1.9453281515272314,
                0.03657617233281396
            ],
            "color": "#333736",
            "type": "space"
        },
        {
            "position": [
                74.75564270290265,
                10.678633911141212,
                41.75599541314337
            ],
            "color": "#e2af6b",
            "type": "space"
        }
    ],
    [
        {
            "position": [
                38.29223743856003,
                13.598775200833662,
                25.0416674207659
            ],
            "color": "#7a5132",
            "type": "space"
        },
        {
            "position": [
                30.709854392127482,
                10.48170660717912,
                9.485479143959118
            ],
            "color": "#5d423a",
            "type": "space"
        },
        {
            "position": [
                38.212182858976355,
                10.188741043221539,
                24.21843035639154
            ],
            "color": "#755333",
            "type": "space"
        },
        {
            "position": [
                54.31622822414411,
                -25.00659423536472,
                41.3976259341263
            ],
            "color": "#6d8c36",
            "type": "space"
        },
        {
            "position": [
                51.74844273985602,
                -17.358191143710457,
                43.78648319088245
            ],
            "color": "#75822b",
            "type": "space"
        },
        {
            "position": [
                49.94204730492255,
                -18.54451921145328,
                40.31299132589825
            ],
            "color": "#6d7e2e",
            "type": "space"
        },
        {
            "position": [
                40.2101155893605,
                -21.093120453369334,
                26.919540274424914
            ],
            "color": "#4a6731",
            "type": "space"
        },
        {
            "position": [
                30.829854960985692,
                -15.10176859703391,
                2.027264767527759
            ],
            "color": "#2d4f45",
            "type": "space"
        },
        {
            "position": [
                25.616809641828944,
                -1.5797794506967333,
                -8.909567357046244
            ],
            "color": "#323e4a",
            "type": "space"
        },
        {
            "position": [
                23.039734612621587,
                -2.0339941462436117,
                -2.1122580431559013
            ],
            "color": "#32383a",
            "type": "space"
        },
        {
            "position": [
                15.310611174859076,
                1.5385910335991293,
                -6.196067739639322
            ],
            "color": "#24262f",
            "type": "space"
        },
        {
            "position": [
                23.48289529009883,
                -5.018627034461042,
                3.225058903909317
            ],
            "color": "#323a33",
            "type": "space"
        },
        {
            "position": [
                61.62502999965659,
                -15.050203804102935,
                31.472148918331477
            ],
            "color": "#8e9b5c",
            "type": "space"
        }
    ],
    [
        {
            "position": [
                36.15304141684568,
                9.540739246019475,
                13.442816263969515
            ],
            "color": "#6b4f40",
            "type": "space"
        },
        {
            "position": [
                31.03361445108883,
                12.374282148788913,
                2.2093167030681093
            ],
            "color": "#5d4246",
            "type": "space"
        },
        {
            "position": [
                33.52469233769491,
                6.179686636694159,
                9.591405937437669
            ],
            "color": "#5e4b40",
            "type": "space"
        },
        {
            "position": [
                49.02383308402632,
                -42.02326770834938,
                24.478230401507506
            ],
            "color": "#238549",
            "type": "space"
        },
        {
            "position": [
                45.41070307799073,
                -23.890632024673536,
                30.12368550158152
            ],
            "color": "#537537",
            "type": "space"
        },
        {
            "position": [
                43.980005148206054,
                -19.542956216468898,
                19.947920032529474
            ],
            "color": "#527046",
            "type": "space"
        },
        {
            "position": [
                33.850697731427005,
                -17.69530723261681,
                5.762094438083764
            ],
            "color": "#325746",
            "type": "space"
        },
        {
            "position": [
                43.32236557966734,
                8.583139827680276,
                -51.99507014408524
            ],
            "color": "#0067bd",
            "type": "space"
        },
        {
            "position": [
                34.79407576051878,
                24.638305057110678,
                -52.73058757881118
            ],
            "color": "#3849a7",
            "type": "space"
        },
        {
            "position": [
                26.762234120265887,
                29.53591573957684,
                -51.8526309262712
            ],
            "color": "#303390",
            "type": "space"
        },
        {
            "position": [
                18.82381847745635,
                2.1753363463304645,
                -4.320937376694189
            ],
            "color": "#2e2d34",
            "type": "space"
        },
        {
            "position": [
                23.263929461852562,
                -3.7186313975449137,
                2.2528114960366885
            ],
            "color": "#333934",
            "type": "space"
        },
        {
            "position": [
                62.22312125626617,
                -9.306413369905563,
                -32.250819475136616
            ],
            "color": "#509ecf",
            "type": "space"
        }
    ],
    [
        {
            "position": [
                27.955214694838773,
                6.47850452260526,
                -5.847172366337539
            ],
            "color": "#483f4b",
            "type": "space"
        },
        {
            "position": [
                27.697230162501334,
                10.016165512525294,
                -23.213220026168813
            ],
            "color": "#3c3e65",
            "type": "space"
        },
        {
            "position": [
                27.544360714127833,
                1.4126833642221504,
                -9.8529022722181
            ],
            "color": "#3b4150",
            "type": "space"
        },
        {
            "position": [
                32.00874191155729,
                -17.505709974971417,
                -3.3141510355078285
            ],
            "color": "#215350",
            "type": "space"
        },
        {
            "position": [
                29.671179272335173,
                -9.414328427558793,
                2.3534257752899745
            ],
            "color": "#374a42",
            "type": "space"
        },
        {
            "position": [
                29.7979179903138,
                -3.6623204289103484,
                -15.531964178486712
            ],
            "color": "#2e495e",
            "type": "space"
        },
        {
            "position": [
                28.91762764386865,
                -1.5299670375226448,
                -15.589734027347578
            ],
            "color": "#31465c",
            "type": "space"
        },
        {
            "position": [
                35.36681638241658,
                21.38504406979949,
                -49.40595258657295
            ],
            "color": "#394ca3",
            "type": "space"
        },
        {
            "position": [
                35.41282712465328,
                27.00036409568182,
                -59.4839851960044
            ],
            "color": "#2b4ab4",
            "type": "space"
        },
        {
            "position": [
                30.646008582866827,
                31.72047966925301,
                -57.08989453728906
            ],
            "color": "#343ba3",
            "type": "space"
        },
        {
            "position": [
                19.108629414026844,
                2.1205594610211875,
                -9.447709267094929
            ],
            "color": "#2a2e3c",
            "type": "space"
        },
        {
            "position": [
                23.322354839305838,
                -0.4542925400959352,
                -3.6894160212806226
            ],
            "color": "#34383d",
            "type": "space"
        },
        {
            "position": [
                46.089473442316326,
                14.154955990506368,
                -48.61850578085911
            ],
            "color": "#456abf",
            "type": "space"
        }
    ],
    [
        {
            "position": [
                27.40294698726109,
                2.898568723053163,
                4.484912318184142
            ],
            "color": "#483f3a",
            "type": "space"
        },
        {
            "position": [
                26.408115245888737,
                6.30535256449713,
                -10.884895290296704
            ],
            "color": "#403c4f",
            "type": "space"
        },
        {
            "position": [
                25.739188234309857,
                1.9387765589633232,
                0.0020274874887871164
            ],
            "color": "#403c3d",
            "type": "space"
        },
        {
            "position": [
                31.292010677915258,
                -14.599496199160011,
                0.1478276545243573
            ],
            "color": "#2d5049",
            "type": "space"
        },
        {
            "position": [
                30.383582489119902,
                -8.367725198903415,
                6.6450586763680874
            ],
            "color": "#3e4b3d",
            "type": "space"
        },
        {
            "position": [
                28.325513131391418,
                -4.776276881006542,
                0.43917722857299557
            ],
            "color": "#3b4542",
            "type": "space"
        },
        {
            "position": [
                25.05646516651339,
                -2.221452840742794,
                -8.451573160017734
            ],
            "color": "#303d48",
            "type": "space"
        },
        {
            "position": [
                27.642236679850832,
                29.41632697715707,
                -51.639918690650276
            ],
            "color": "#333592",
            "type": "space"
        },
        {
            "position": [
                31.11189795183003,
                27.64560953333442,
                -55.7450877179343
            ],
            "color": "#2c3fa2",
            "type": "space"
        },
        {
            "position": [
                26.570340952286998,
                32.75476894181303,
                -52.76496567125518
            ],
            "color": "#363091",
            "type": "space"
        },
        {
            "position": [
                16.498677200498463,
                2.621384710977226,
                -6.480712824597612
            ],
            "color": "#282832",
            "type": "space"
        },
        {
            "position": [
                22.23755353887944,
                0.7821086553148615,
                -3.279711745984726
            ],
            "color": "#34353a",
            "type": "space"
        },
        {
            "position": [
                47.01108490073589,
                16.1057373704242,
                -48.270421280877216
            ],
            "color": "#4f6bc1",
            "type": "space"
        }
    ],
    [
        {
            "position": [
                20.263992667740595,
                -0.19692387764849717,
                -0.7884722514595932
            ],
            "color": "#303132",
            "type": "space"
        },
        {
            "position": [
                20.6639998202391,
                -0.38218107807905244,
                -1.569387756892382
            ],
            "color": "#303234",
            "type": "space"
        },
        {
            "position": [
                19.40865458976276,
                0.2949307351679531,
                -2.0696869987866795
            ],
            "color": "#2e2f32",
            "type": "space"
        },
        {
            "position": [
                18.77490933093287,
                -0.17602603768629432,
                -4.433779198899435
            ],
            "color": "#2a2e34",
            "type": "space"
        },
        {
            "position": [
                23.148638447882973,
                -1.7003512293302658,
                -0.5875183086367253
            ],
            "color": "#343838",
            "type": "space"
        },
        {
            "position": [
                18.828323262583204,
                -0.033174907365818296,
                -3.652505181742738
            ],
            "color": "#2b2e33",
            "type": "space"
        },
        {
            "position": [
                17.262138918976333,
                1.6302090361040855,
                -5.320033475631247
            ],
            "color": "#292a32",
            "type": "space"
        },
        {
            "position": [
                19.114426594010325,
                1.2305601741682548,
                -3.1960417125193596
            ],
            "color": "#2e2e33",
            "type": "space"
        },
        {
            "position": [
                20.078766232268613,
                2.1771569046413197,
                -8.63046363869897
            ],
            "color": "#2d303d",
            "type": "space"
        },
        {
            "position": [
                18.241134023022134,
                1.8871781552227407,
                -5.918473718933681
            ],
            "color": "#2b2c35",
            "type": "space"
        },
        {
            "position": [
                10.97942105816535,
                3.381354270678927,
                -1.854387250543088
            ],
            "color": "#211c20",
            "type": "space"
        },
        {
            "position": [
                17.44455584237312,
                2.117539174354366,
                -2.916557053826352
            ],
            "color": "#2c2a2f",
            "type": "space"
        },
        {
            "position": [
                19.23115973054808,
                8.330942030987387,
                -19.495680833470384
            ],
            "color": "#2a2c4b",
            "type": "space"
        }
    ],
    [
        {
            "position": [
                25.690656538020477,
                3.322253773280659,
                3.2959781523278386
            ],
            "color": "#443b38",
            "type": "space"
        },
        {
            "position": [
                22.552706714664758,
                -0.19422693823595294,
                -0.7765744301074462
            ],
            "color": "#353637",
            "type": "space"
        },
        {
            "position": [
                23.884655379299687,
                1.5258922500092642,
                1.249335202463575
            ],
            "color": "#3c3837",
            "type": "space"
        },
        {
            "position": [
                24.732034560586968,
                -3.0352373511220163,
                1.7502290974061419
            ],
            "color": "#373c38",
            "type": "space"
        },
        {
            "position": [
                27.765913258678566,
                -6.167289380623525,
                6.79175428347909
            ],
            "color": "#3c4437",
            "type": "space"
        },
        {
            "position": [
                23.059296535362833,
                -2.119316040464475,
                -0.7289630220914667
            ],
            "color": "#333838",
            "type": "space"
        },
        {
            "position": [
                25.55228327440806,
                -6.039102201038732,
                4.897847781796971
            ],
            "color": "#363f35",
            "type": "space"
        },
        {
            "position": [
                23.26717813730758,
                -1.3175556304768354,
                0.9507228921745825
            ],
            "color": "#363836",
            "type": "space"
        },
        {
            "position": [
                23.82768182269318,
                -0.30050414115068147,
                -2.9197833185089173
            ],
            "color": "#36393d",
            "type": "space"
        },
        {
            "position": [
                22.492642921434715,
                -0.3789466630859939,
                -1.5508518568436047
            ],
            "color": "#343638",
            "type": "space"
        },
        {
            "position": [
                17.712695589029927,
                1.2455582928594944,
                -3.228073546426402
            ],
            "color": "#2b2b30",
            "type": "space"
        },
        {
            "position": [
                21.02197996824745,
                -1.1037897146828624,
                0.33119929467053666
            ],
            "color": "#313332",
            "type": "space"
        },
        {
            "position": [
                21.11392814306941,
                3.7942196440062803,
                -2.1922863776846935
            ],
            "color": "#373136",
            "type": "space"
        }
    ],
    [
        {
            "position": [
                54.926117872537404,
                50.97462471286357,
                23.350905755365204
            ],
            "color": "#da595e",
            "type": "space"
        },
        {
            "position": [
                55.48958382806123,
                39.283068761593654,
                -2.2009608927179958
            ],
            "color": "#c2698a",
            "type": "space"
        },
        {
            "position": [
                58.22100220457173,
                28.71226584707387,
                29.976447995860568
            ],
            "color": "#c87759",
            "type": "space"
        },
        {
            "position": [
                90.03625451447931,
                -13.678475448212824,
                68.2323107233938
            ],
            "color": "#f0e758",
            "type": "space"
        },
        {
            "position": [
                80.05094320192248,
                12.61625983815251,
                75.54508646561338
            ],
            "color": "#febb29",
            "type": "space"
        },
        {
            "position": [
                79.85272539106576,
                2.8330679741453424,
                38.4777850165684
            ],
            "color": "#e3c27e",
            "type": "space"
        },
        {
            "position": [
                65.52339677784168,
                -13.941967729528715,
                27.043365140939702
            ],
            "color": "#98a56e",
            "type": "space"
        },
        {
            "position": [
                67.2376744664897,
                -14.206156631331734,
                -23.35191247843118
            ],
            "color": "#63adcd",
            "type": "space"
        },
        {
            "position": [
                47.50052993580822,
                14.252475838779255,
                -45.75107102738498
            ],
            "color": "#516dbe",
            "type": "space"
        },
        {
            "position": [
                47.79061790689739,
                15.427671760023243,
                -45.85238186571401
            ],
            "color": "#556dbf",
            "type": "space"
        },
        {
            "position": [
                26.300689679394104,
                2.390333120450533,
                -24.23235628998006
            ],
            "color": "#253f63",
            "type": "space"
        },
        {
            "position": [
                26.52561704256324,
                -0.6446233022717462,
                0.4653734545549293
            ],
            "color": "#3e3f3e",
            "type": "space"
        },
        {
            "position": [
                90.97910252697031,
                -0.6906908424175184,
                7.423462867489983
            ],
            "color": "#eae5d7",
            "type": "space"
        }
    ]
]
const demoTargetColor = {
    "position": [
        63.83453803473043,
        -45.97013072498157,
        7.45367501784473
    ],
    "color": "#07af8c",
    "type": "target"
}

const coordinateIndex = [[1, 2], [0, 1], [0, 2]];
const abRange = [-127, 128];
const LRange = [0, 100];
const circleSize = 8;

// Good Job!
export const SpacePlot = ({
    spaceIndex = 0,
}) => {
    // copy from PaintingBoard.js
    const svgRef = useRef(null);
    const [svgSize, setSvgSize] = useState([0, 0]);
    const [svgOffset, setSvgOffset] = useState([0, 0]);

    useEffect(() => {
        setSvgSize([
            svgRef.current?.clientWidth || 0,
            svgRef.current?.clientHeight || 0
        ])

        setSvgOffset([
            svgRef.current?.getBoundingClientRect().x || 0,
            svgRef.current?.getBoundingClientRect().y || 0
        ])
    }, [svgRef])

    const [currentLT, setCurrentLT] = useState([0, 0]);
    const [currentScale, setCurrentScale] = useState(1);
    const maxScale = 10;
    const minScale = 1;

    // 拖拽
    const [isMaskDrag, setIsMaskDrag] = useState(false);
    const [maskMoveP, setMaskMoveP] = useState([0, 0]);
    const handleDragStart = (e) => {
        setIsMaskDrag(true);
        setMaskMoveP([
            e.clientX,
            e.clientY,
        ]);
    }

    const handleDragMove = (e) => {
        if (isMaskDrag) {
            if (e.clientX !== maskMoveP[0] || e.clientY !== maskMoveP[1]) {
                setCurrentLT([
                    currentLT[0] + e.clientX - maskMoveP[0],
                    currentLT[1] + e.clientY - maskMoveP[1],
                ]);
                setMaskMoveP([
                    e.clientX,
                    e.clientY
                ])
            }
        }
    }

    const handleDragEnd = (e) => {
        if (isMaskDrag) {
            setIsMaskDrag(false);
            setMaskMoveP([0, 0]);
        }
    }

    // 缩放
    const handleWheelChange = (e) => {
        const v = e.deltaY;
        let newScale = 1;
        const currentScaleRecord = currentScale;
        if (v < 0) {
            newScale = Math.min(maxScale, currentScale * 1.25);
            setCurrentScale(newScale);

        } else if (v > 0) {
            newScale = Math.max(minScale, currentScale / 1.25);
            setCurrentScale(newScale);
        }

        // new feat: 缩放时focus不变
        const deltaX = e.clientX - svgOffset[0] - currentLT[0];
        const deltaY = e.clientY - svgOffset[1] - currentLT[1];

        setCurrentLT([
            currentLT[0] - ((newScale - currentScaleRecord) / currentScaleRecord) * deltaX,
            currentLT[1] - ((newScale - currentScaleRecord) / currentScaleRecord) * deltaY,
        ])
    }

    useEffect(() => {
        if (svgSize[0] > 0) {
            const leftTopSvg = [Math.abs(currentLT[0]), Math.abs(currentLT[1])];

            const leftTopLab = [];
            const rightBottomLab = [];
            if (spaceIndex === 0) {
                leftTopLab.push(abRange[0] + ((leftTopSvg[0] + circleSize * 0.5) / (svgSize[0] * currentScale)) * (abRange[1] - abRange[0]));
                leftTopLab.push(abRange[0] + ((leftTopSvg[1] + circleSize * 0.5) / (svgSize[1] * currentScale)) * (abRange[1] - abRange[0]));

                rightBottomLab.push(leftTopLab[0] + ((svgSize[0] - circleSize) / (svgSize[0] * currentScale)) * (abRange[1] - abRange[0]));
                rightBottomLab.push(leftTopLab[1] + ((svgSize[1] - circleSize) / (svgSize[1] * currentScale)) * (abRange[1] - abRange[0]));
            } else if (spaceIndex === 1) {
                // TODO
                // LeftTopLab calculation
                leftTopLab.push(LRange[0] + ((leftTopSvg[0] + circleSize * 0.5) / (svgSize[0] * currentScale)) * (LRange[1] - LRange[0]));
                leftTopLab.push(LRange[0] + ((leftTopSvg[1] + circleSize * 0.5) / (svgSize[1] * currentScale)) * (LRange[1] - LRange[0]));

                // RightBottomLab calculation
                rightBottomLab.push(leftTopLab[0] + ((svgSize[0] - circleSize) / (svgSize[0] * currentScale)) * (LRange[1] - LRange[0]));
                rightBottomLab.push(leftTopLab[1] + ((svgSize[1] - circleSize) / (svgSize[1] * currentScale)) * (LRange[1] - LRange[0]));
            } else if (spaceIndex === 2) {
                // TODO
                // LeftTopLab calculation
                leftTopLab.push(LRange[0] + ((leftTopSvg[0] + circleSize * 0.5) / (svgSize[0] * currentScale)) * (LRange[1] - LRange[0]));
                leftTopLab.push(LRange[0] + ((leftTopSvg[1] + circleSize * 0.5) / (svgSize[1] * currentScale)) * (LRange[1] - LRange[0]));

                // RightBottomLab calculation
                rightBottomLab.push(leftTopLab[0] + ((svgSize[0] - circleSize) / (svgSize[0] * currentScale)) * (LRange[1] - LRange[0]));
                rightBottomLab.push(leftTopLab[1] + ((svgSize[1] - circleSize) / (svgSize[1] * currentScale)) * (LRange[1] - LRange[0]));

            }

            const circleData = [];
            const cIndex = coordinateIndex[spaceIndex];
            for (let i = 0; i < demoScaterPlotData.length; i++) {
                for (let j = 0; j < demoScaterPlotData[i].length; j++) {
                    const dataSample = demoScaterPlotData[i][j];
                    const cx = dataSample.position[cIndex[0]];
                    const cy = dataSample.position[cIndex[1]];
                    if (cx > leftTopLab[0] && cx < rightBottomLab[0] && cy > leftTopLab[1] && cy < rightBottomLab[1]) {
                        circleData.push([
                            [dataSample.position[cIndex[0]], dataSample.position[cIndex[1]]],
                            dataSample.color,
                            [i, j]
                        ])
                    }
                }
            }

            // target color
            const cx = demoTargetColor.position[cIndex[0]];
            const cy = demoTargetColor.position[cIndex[1]];
            if (cx > leftTopLab[0] && cx < rightBottomLab[0] && cy > leftTopLab[1] && cy < rightBottomLab[1]) {
                circleData.push([
                    [demoTargetColor.position[cIndex[0]], demoTargetColor.position[cIndex[1]]],
                    demoTargetColor.color,
                    [-1, -1]
                ])
            }

            const svg = d3.select("#space-svg");
            svg
                .selectAll("circle")
                .remove();

            svg
                .selectAll("circle")
                .data(circleData)
                .enter()
                .append("circle")
                .attr("cx", d => svgSize[0] * (d[0][0] - leftTopLab[0]) / (rightBottomLab[0] - leftTopLab[0]))
                .attr("cy", d => svgSize[1] * (d[0][1] - leftTopLab[1]) / (rightBottomLab[1] - leftTopLab[1]))
                .attr("r", circleSize)
                .attr("fill", d => d[1])
                .attr("stroke", d => d[2][0] === -1 ? "#5a4e3b" : "none")
                .attr("stroke-width", d => d[2][0] === -1 ? 3 : 0)
        }
    })

    return <div
        className="SDefault-container"
        style={{
            display: "flex",
            alignItems: "center",
            justifyContent: "center",
        }}
    >
        <div
            className="Plot-container"
            ref={svgRef}
        >
            <div
                style={{
                    width: `${svgSize[0] * currentScale}px`,
                    height: `${svgSize[1] * currentScale}px`,
                    position: "absolute",
                    zIndex: "30",
                    left: `${currentLT[0]}px`,
                    top: `${currentLT[1]}px`,
                }}
                onMouseDown={(e) => handleDragStart(e)}
                onMouseMove={(e) => handleDragMove(e)}
                onMouseUp={(e) => handleDragEnd(e)}
                onWheel={(e) => handleWheelChange(e)}
            >
            </div>
            <svg id="space-svg" className="SDefault-container" />
        </div>
    </div>
}
